Using TensorFlow backend.
/cbr/saish/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])

############## Hyperparameters Values ##############
Number of Hidden Layers: 5
Layer Sizes: [784, 128, 128, 128, 128, 128, 10]
Number of Epochs: 5
Learning Rate: 0.001
Optimizer: nadam
Batch Size: 32
Activation Function: relu
Loss Function: squared_error
Output Activation Funtion: softmax
Initializer: xavier
###################################################

 =============== Epoch Number: 1 =============== 
  0%|          | 0/54000 [00:00<?, ?it/s]  0%|          | 29/54000 [00:00<03:11, 282.16it/s]  0%|          | 61/54000 [00:00<03:04, 291.93it/s]  0%|          | 134/54000 [00:00<02:31, 355.61it/s]  0%|          | 193/54000 [00:00<02:13, 402.82it/s]  1%|          | 272/54000 [00:00<01:53, 471.66it/s]  1%|          | 351/54000 [00:00<01:40, 536.15it/s]  1%|          | 411/54000 [00:00<01:39, 539.68it/s]  1%|          | 481/54000 [00:00<01:32, 578.52it/s]  1%|          | 576/54000 [00:00<01:22, 650.82it/s]  1%|          | 661/54000 [00:01<01:16, 699.90it/s]  1%|▏         | 737/54000 [00:01<01:23, 641.21it/s]  1%|▏         | 806/54000 [00:01<01:33, 571.88it/s]  2%|▏         | 868/54000 [00:01<01:37, 545.11it/s]  2%|▏         | 926/54000 [00:01<02:02, 432.11it/s]  2%|▏         | 979/54000 [00:01<01:56, 455.77it/s]  2%|▏         | 1030/54000 [00:01<02:06, 417.83it/s]  2%|▏         | 1087/54000 [00:01<01:56, 454.11it/s]  2%|▏         | 1137/54000 [00:02<02:07, 414.71it/s]  2%|▏         | 1185/54000 [00:02<02:02, 431.03it/s]  2%|▏         | 1243/54000 [00:02<01:53, 466.76it/s]  2%|▏         | 1293/54000 [00:02<01:52, 470.54it/s]  2%|▏         | 1344/54000 [00:02<01:51, 473.38it/s]  3%|▎         | 1393/54000 [00:02<01:54, 459.94it/s]  3%|▎         | 1440/54000 [00:03<04:50, 180.72it/s]  3%|▎         | 1476/54000 [00:03<05:56, 147.30it/s]  3%|▎         | 1504/54000 [00:04<07:45, 112.66it/s]  3%|▎         | 1576/54000 [00:04<05:47, 150.82it/s]  3%|▎         | 1620/54000 [00:04<04:39, 187.28it/s]  3%|▎         | 1659/54000 [00:04<04:14, 205.53it/s]  3%|▎         | 1694/54000 [00:04<03:54, 222.73it/s]  3%|▎         | 1727/54000 [00:04<03:38, 238.70it/s]  3%|▎         | 1759/54000 [00:04<03:28, 250.07it/s]  3%|▎         | 1824/54000 [00:04<02:51, 305.02it/s]  3%|▎         | 1886/54000 [00:04<02:25, 359.25it/s]  4%|▎         | 1939/54000 [00:05<02:10, 397.42it/s]  4%|▎         | 2000/54000 [00:05<01:57, 442.65it/s]  4%|▍         | 2056/54000 [00:05<01:50, 471.31it/s]  4%|▍         | 2114/54000 [00:05<01:44, 498.08it/s]  4%|▍         | 2175/54000 [00:05<01:38, 526.01it/s]  4%|▍         | 2232/54000 [00:05<01:39, 522.24it/s]  4%|▍         | 2298/54000 [00:05<01:33, 555.85it/s]  4%|▍         | 2356/54000 [00:05<01:32, 560.91it/s]  4%|▍         | 2414/54000 [00:05<01:31, 561.91it/s]  5%|▍         | 2473/54000 [00:05<01:30, 569.58it/s]  5%|▍         | 2531/54000 [00:06<01:32, 556.38it/s]  5%|▍         | 2590/54000 [00:06<01:33, 552.53it/s]  5%|▍         | 2646/54000 [00:06<01:52, 455.07it/s]  5%|▍         | 2695/54000 [00:06<01:58, 432.17it/s]  5%|▌         | 2741/54000 [00:06<02:02, 419.36it/s]  5%|▌         | 2785/54000 [00:06<02:18, 369.35it/s]  5%|▌         | 2825/54000 [00:06<02:21, 362.39it/s]  5%|▌         | 2863/54000 [00:06<02:19, 365.74it/s]  5%|▌         | 2901/54000 [00:07<02:20, 364.24it/s]  5%|▌         | 2939/54000 [00:07<02:24, 353.55it/s]  6%|▌         | 2982/54000 [00:07<02:16, 373.11it/s]  6%|▌         | 3049/54000 [00:07<01:58, 429.50it/s]  6%|▌         | 3097/54000 [00:07<01:54, 442.74it/s]  6%|▌         | 3144/54000 [00:07<01:55, 439.77it/s]  6%|▌         | 3190/54000 [00:07<02:01, 418.21it/s]  6%|▌         | 3238/54000 [00:07<01:57, 433.49it/s]  6%|▌         | 3283/54000 [00:07<02:03, 409.50it/s]  6%|▌         | 3333/54000 [00:08<01:57, 432.08it/s]  6%|▋         | 3396/54000 [00:08<01:46, 476.90it/s]  6%|▋         | 3458/54000 [00:08<01:38, 511.90it/s]  7%|▋         | 3515/54000 [00:08<01:35, 527.82it/s]  7%|▋         | 3570/54000 [00:08<01:37, 516.11it/s]  7%|▋         | 3623/54000 [00:08<01:37, 517.66it/s]  7%|▋         | 3676/54000 [00:08<01:40, 501.97it/s]  7%|▋         | 3727/54000 [00:08<01:51, 449.15it/s]  7%|▋         | 3774/54000 [00:08<02:11, 381.85it/s]  7%|▋         | 3816/54000 [00:09<02:47, 299.22it/s]  7%|▋         | 3851/54000 [00:09<02:43, 306.44it/s]  7%|▋         | 3886/54000 [00:09<02:45, 302.51it/s]  7%|▋         | 3919/54000 [00:09<02:43, 305.42it/s]  7%|▋         | 3966/54000 [00:09<02:26, 340.85it/s]  7%|▋         | 4032/54000 [00:09<02:05, 396.93it/s]  8%|▊         | 4096/54000 [00:09<01:51, 447.33it/s]  8%|▊         | 4161/54000 [00:09<01:41, 492.37it/s]  8%|▊         | 4229/54000 [00:10<01:32, 535.67it/s]  8%|▊         | 4296/54000 [00:10<01:27, 568.73it/s]  8%|▊         | 4361/54000 [00:10<01:24, 590.36it/s]  8%|▊         | 4424/54000 [00:10<01:27, 567.48it/s]  8%|▊         | 4484/54000 [00:10<01:31, 540.95it/s]  8%|▊         | 4540/54000 [00:10<01:32, 536.92it/s]  9%|▊         | 4605/54000 [00:10<01:27, 565.09it/s]  9%|▊         | 4667/54000 [00:10<01:25, 578.24it/s]  9%|▉         | 4728/54000 [00:10<01:24, 585.75it/s]  9%|▉         | 4792/54000 [00:10<01:21, 600.73it/s]  9%|▉         | 4853/54000 [00:11<01:38, 496.76it/s]  9%|▉         | 4915/54000 [00:11<01:33, 526.37it/s]  9%|▉         | 4971/54000 [00:11<01:32, 530.84it/s]  9%|▉         | 5034/54000 [00:11<01:27, 556.97it/s]  9%|▉         | 5102/54000 [00:11<01:23, 587.71it/s] 10%|▉         | 5169/54000 [00:11<01:20, 608.90it/s] 10%|▉         | 5232/54000 [00:11<01:35, 508.02it/s] 10%|▉         | 5296/54000 [00:11<01:30, 540.43it/s] 10%|▉         | 5354/54000 [00:12<01:39, 491.22it/s] 10%|█         | 5412/54000 [00:12<01:34, 514.22it/s] 10%|█         | 5466/54000 [00:12<01:34, 512.09it/s] 10%|█         | 5519/54000 [00:12<01:41, 476.76it/s] 10%|█         | 5573/54000 [00:12<01:38, 493.93it/s] 10%|█         | 5624/54000 [00:12<01:49, 442.63it/s] 11%|█         | 5671/54000 [00:12<02:06, 380.67it/s] 11%|█         | 5724/54000 [00:12<01:56, 415.23it/s] 11%|█         | 5769/54000 [00:13<02:14, 359.75it/s] 11%|█         | 5809/54000 [00:13<02:12, 362.59it/s] 11%|█         | 5874/54000 [00:13<01:55, 418.02it/s] 11%|█         | 5935/54000 [00:13<01:44, 460.67it/s] 11%|█         | 5995/54000 [00:13<01:37, 494.15it/s] 11%|█         | 6060/54000 [00:13<01:30, 531.40it/s] 11%|█▏        | 6117/54000 [00:13<01:32, 515.58it/s] 11%|█▏        | 6172/54000 [00:13<01:45, 451.38it/s] 12%|█▏        | 6221/54000 [00:13<01:50, 433.13it/s] 12%|█▏        | 6267/54000 [00:14<01:56, 409.80it/s] 12%|█▏        | 6310/54000 [00:14<02:04, 382.52it/s] 12%|█▏        | 6356/54000 [00:14<01:58, 401.81it/s] 12%|█▏        | 6416/54000 [00:14<01:46, 445.42it/s] 12%|█▏        | 6478/54000 [00:14<01:37, 485.53it/s] 12%|█▏        | 6540/54000 [00:14<01:31, 517.85it/s] 12%|█▏        | 6595/54000 [00:14<02:02, 387.07it/s] 12%|█▏        | 6641/54000 [00:15<03:08, 250.73it/s] 12%|█▏        | 6677/54000 [00:15<03:32, 222.46it/s] 12%|█▏        | 6708/54000 [00:15<03:33, 221.99it/s] 12%|█▏        | 6736/54000 [00:15<03:20, 235.59it/s] 13%|█▎        | 6764/54000 [00:15<03:15, 241.16it/s] 13%|█▎        | 6817/54000 [00:15<02:43, 287.75it/s] 13%|█▎        | 6852/54000 [00:15<02:37, 300.26it/s] 13%|█▎        | 6912/54000 [00:16<02:13, 352.17it/s] 13%|█▎        | 6976/54000 [00:16<01:55, 405.60it/s] 13%|█▎        | 7041/54000 [00:16<01:42, 456.87it/s] 13%|█▎        | 7105/54000 [00:16<01:33, 498.93it/s] 13%|█▎        | 7170/54000 [00:16<01:27, 535.77it/s] 13%|█▎        | 7235/54000 [00:16<01:22, 564.07it/s] 14%|█▎        | 7300/54000 [00:16<01:19, 585.08it/s] 14%|█▎        | 7362/54000 [00:16<01:20, 578.95it/s] 14%|█▎        | 7424/54000 [00:16<01:20, 580.30it/s] 14%|█▍        | 7484/54000 [00:17<01:26, 538.08it/s] 14%|█▍        | 7546/54000 [00:17<01:22, 559.89it/s] 14%|█▍        | 7611/54000 [00:17<01:19, 582.66it/s] 14%|█▍        | 7671/54000 [00:17<01:22, 564.90it/s] 14%|█▍        | 7729/54000 [00:17<01:25, 540.21it/s] 14%|█▍        | 7784/54000 [00:17<01:26, 536.92it/s] 15%|█▍        | 7840/54000 [00:17<01:26, 535.60it/s] 15%|█▍        | 7904/54000 [00:17<01:23, 551.65it/s] 15%|█▍        | 7968/54000 [00:17<01:21, 565.04it/s] 15%|█▍        | 8032/54000 [00:17<01:20, 574.42it/s] 15%|█▍        | 8090/54000 [00:18<01:20, 573.60it/s] 15%|█▌        | 8148/54000 [00:18<01:20, 568.87it/s] 15%|█▌        | 8206/54000 [00:18<01:21, 563.19it/s] 15%|█▌        | 8263/54000 [00:18<01:20, 565.04it/s] 15%|█▌        | 8323/54000 [00:18<01:19, 574.25it/s] 16%|█▌        | 8382/54000 [00:18<01:25, 534.64it/s] 16%|█▌        | 8437/54000 [00:18<01:39, 458.77it/s] 16%|█▌        | 8496/54000 [00:18<01:32, 490.33it/s] 16%|█▌        | 8548/54000 [00:19<01:41, 447.88it/s] 16%|█▌        | 8608/54000 [00:19<01:34, 480.74it/s] 16%|█▌        | 8669/54000 [00:19<01:28, 512.36it/s] 16%|█▌        | 8724/54000 [00:19<01:26, 521.79it/s] 16%|█▋        | 8781/54000 [00:19<01:24, 533.97it/s] 16%|█▋        | 8844/54000 [00:19<01:20, 558.34it/s] 16%|█▋        | 8907/54000 [00:19<01:18, 577.88it/s] 17%|█▋        | 8968/54000 [00:19<01:16, 585.88it/s] 17%|█▋        | 9028/54000 [00:19<01:17, 579.32it/s] 17%|█▋        | 9087/54000 [00:19<01:17, 579.99it/s] 17%|█▋        | 9146/54000 [00:20<01:17, 576.78it/s] 17%|█▋        | 9209/54000 [00:20<01:15, 591.08it/s] 17%|█▋        | 9273/54000 [00:20<01:14, 603.03it/s] 17%|█▋        | 9334/54000 [00:20<01:17, 579.92it/s] 17%|█▋        | 9397/54000 [00:20<01:15, 592.77it/s] 18%|█▊        | 9457/54000 [00:20<01:16, 579.39it/s] 18%|█▊        | 9516/54000 [00:20<01:18, 563.58it/s] 18%|█▊        | 9573/54000 [00:20<01:51, 399.83it/s] 18%|█▊        | 9620/54000 [00:21<02:46, 266.93it/s] 18%|█▊        | 9658/54000 [00:21<03:14, 228.23it/s] 18%|█▊        | 9690/54000 [00:21<03:00, 245.07it/s] 18%|█▊        | 9759/54000 [00:21<02:25, 303.50it/s] 18%|█▊        | 9824/54000 [00:21<02:03, 359.09it/s] 18%|█▊        | 9887/54000 [00:21<01:47, 411.64it/s] 18%|█▊        | 9950/54000 [00:21<01:35, 459.22it/s] 19%|█▊        | 10015/54000 [00:22<01:27, 503.50it/s] 19%|█▊        | 10074/54000 [00:22<01:28, 495.55it/s] 19%|█▉        | 10130/54000 [00:22<01:39, 441.84it/s] 19%|█▉        | 10198/54000 [00:22<01:28, 493.01it/s] 19%|█▉        | 10263/54000 [00:22<01:22, 531.39it/s] 19%|█▉        | 10324/54000 [00:22<01:19, 548.50it/s] 19%|█▉        | 10383/54000 [00:22<01:21, 533.21it/s] 19%|█▉        | 10439/54000 [00:22<01:22, 529.64it/s] 19%|█▉        | 10501/54000 [00:22<01:18, 553.73it/s] 20%|█▉        | 10558/54000 [00:23<01:17, 558.07it/s] 20%|█▉        | 10567/54000 [00:23<01:34, 457.23it/s]
Traceback (most recent call last):
  File "main.py", line 109, in <module>
    main(args)
  File "main.py", line 96, in main
    network.train(x_train, y_train, x_val, y_val)
  File "/cbr/saish/PhD/DL/Assignment_1/FeedForwardNN.py", line 583, in train
    self.do_nadam(x_train, y_train, x_val, y_val)
  File "/cbr/saish/PhD/DL/Assignment_1/FeedForwardNN.py", line 531, in do_nadam
    current_gradients = self.backwardPropagation(y, activations, pre_activations)
  File "/cbr/saish/PhD/DL/Assignment_1/FeedForwardNN.py", line 145, in backwardPropagation
    gradients['a' + str(k-1)] = gradients['h' + str(k-1)] * self.activation(pre_activations['a' + str(k-1)], derivative=True)
KeyboardInterrupt
