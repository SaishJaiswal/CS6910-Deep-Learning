Using TensorFlow backend.
/cbr/saish/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/cbr/saish/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Namespace(activation='relu', batch_size=64, epochs=5, initializer='xavier', l_rate=0.001, layer_sizes=[784, 128, 32, 10], loss='cross_entropy', n_classes=10, n_layers=4, optimizer='nag', output_activation='softmax')
 =============== Epoch Number: 0 =============== 
  0%|          | 0/54000 [00:00<?, ?it/s]  0%|          | 136/54000 [00:00<00:39, 1354.59it/s]  1%|          | 291/54000 [00:00<00:38, 1404.11it/s]  1%|          | 380/54000 [00:00<00:44, 1193.34it/s]  1%|          | 468/54000 [00:00<00:49, 1074.66it/s]  1%|          | 558/54000 [00:00<00:52, 1011.87it/s]  1%|          | 647/54000 [00:00<00:55, 969.06it/s]   1%|▏         | 744/54000 [00:00<00:54, 968.83it/s]  2%|▏         | 909/54000 [00:00<00:48, 1105.73it/s]  2%|▏         | 1076/54000 [00:00<00:43, 1229.18it/s]  2%|▏         | 1241/54000 [00:01<00:39, 1330.35it/s]/cbr/saish/PhD/DL/Assignment_1/FeedForwardNN.py:107: RuntimeWarning: overflow encountered in matmul
  pre_activations['a' + str(self.L-1)] = self.parameters['b' + str(self.L-1)] + + np.matmul(self.parameters['W' + str(self.L-1)], activations['h' + str(self.L-1-1)])
/cbr/saish/PhD/DL/Assignment_1/FeedForwardNN.py:59: RuntimeWarning: invalid value encountered in subtract
  exps = np.exp(x - x.max())
/cbr/saish/PhD/DL/Assignment_1/FeedForwardNN.py:103: RuntimeWarning: overflow encountered in matmul
  pre_activations['a' + str(i)] = self.parameters['b' + str(i)] + np.matmul(self.parameters['W' + str(i)], activations['h' + str(i-1)])
/cbr/saish/PhD/DL/Assignment_1/FeedForwardNN.py:107: RuntimeWarning: invalid value encountered in matmul
  pre_activations['a' + str(self.L-1)] = self.parameters['b' + str(self.L-1)] + + np.matmul(self.parameters['W' + str(self.L-1)], activations['h' + str(self.L-1-1)])
  3%|▎         | 1402/54000 [00:01<00:37, 1401.90it/s]  3%|▎         | 1568/54000 [00:01<00:35, 1468.25it/s]  3%|▎         | 1734/54000 [00:01<00:34, 1518.88it/s]  4%|▎         | 1890/54000 [00:01<00:36, 1409.79it/s]  4%|▍         | 2036/54000 [00:01<00:37, 1399.03it/s]  4%|▍         | 2201/54000 [00:01<00:35, 1465.14it/s]  4%|▍         | 2368/54000 [00:01<00:34, 1516.74it/s]  5%|▍         | 2534/54000 [00:01<00:33, 1554.85it/s]  5%|▌         | 2700/54000 [00:01<00:32, 1584.50it/s]  5%|▌         | 2867/54000 [00:02<00:31, 1609.01it/s]  6%|▌         | 3030/54000 [00:02<00:31, 1613.20it/s]  6%|▌         | 3197/54000 [00:02<00:31, 1629.21it/s]  6%|▌         | 3363/54000 [00:02<00:30, 1636.20it/s]  7%|▋         | 3528/54000 [00:02<00:30, 1639.55it/s]  7%|▋         | 3694/54000 [00:02<00:30, 1644.71it/s]  7%|▋         | 3860/54000 [00:02<00:30, 1647.10it/s]  7%|▋         | 4026/54000 [00:02<00:30, 1650.72it/s]  8%|▊         | 4192/54000 [00:02<00:30, 1648.30it/s]  8%|▊         | 4358/54000 [00:02<00:30, 1651.20it/s]  8%|▊         | 4524/54000 [00:03<00:30, 1638.97it/s]  9%|▊         | 4688/54000 [00:03<00:30, 1631.91it/s]  9%|▉         | 4855/54000 [00:03<00:29, 1640.72it/s]  9%|▉         | 5020/54000 [00:03<00:29, 1634.57it/s] 10%|▉         | 5185/54000 [00:03<00:29, 1637.15it/s] 10%|▉         | 5349/54000 [00:03<00:34, 1427.62it/s] 10%|█         | 5514/54000 [00:03<00:32, 1487.30it/s] 11%|█         | 5678/54000 [00:03<00:31, 1529.27it/s] 11%|█         | 5844/54000 [00:03<00:30, 1564.16it/s] 11%|█         | 6011/54000 [00:04<00:30, 1593.51it/s] 11%|█▏        | 6175/54000 [00:04<00:29, 1595.19it/s] 12%|█▏        | 6341/54000 [00:04<00:29, 1612.64it/s] 12%|█▏        | 6508/54000 [00:04<00:29, 1627.82it/s] 12%|█▏        | 6674/54000 [00:04<00:28, 1636.90it/s] 13%|█▎        | 6839/54000 [00:04<00:29, 1626.07it/s] 13%|█▎        | 7005/54000 [00:04<00:28, 1635.71it/s] 13%|█▎        | 7170/54000 [00:04<00:28, 1639.67it/s] 14%|█▎        | 7336/54000 [00:04<00:28, 1644.06it/s] 14%|█▍        | 7501/54000 [00:04<00:28, 1630.73it/s] 14%|█▍        | 7668/54000 [00:05<00:28, 1639.48it/s] 15%|█▍        | 7833/54000 [00:05<00:28, 1610.29it/s] 15%|█▍        | 7999/54000 [00:05<00:28, 1623.37it/s] 15%|█▌        | 8165/54000 [00:05<00:28, 1633.11it/s] 15%|█▌        | 8331/54000 [00:05<00:27, 1638.45it/s] 16%|█▌        | 8495/54000 [00:05<00:28, 1621.06it/s] 16%|█▌        | 8658/54000 [00:05<00:30, 1482.44it/s] 16%|█▋        | 8825/54000 [00:05<00:29, 1531.83it/s] 17%|█▋        | 8988/54000 [00:05<00:28, 1558.79it/s] 17%|█▋        | 9153/54000 [00:05<00:28, 1583.76it/s] 17%|█▋        | 9320/54000 [00:06<00:27, 1606.27it/s] 18%|█▊        | 9482/54000 [00:06<00:27, 1602.16it/s] 18%|█▊        | 9647/54000 [00:06<00:27, 1614.45it/s] 18%|█▊        | 9812/54000 [00:06<00:27, 1623.59it/s] 18%|█▊        | 9978/54000 [00:06<00:26, 1633.40it/s] 19%|█▉        | 10143/54000 [00:06<00:26, 1636.93it/s] 19%|█▉        | 10308/54000 [00:06<00:26, 1638.15it/s] 19%|█▉        | 10474/54000 [00:06<00:26, 1643.84it/s] 20%|█▉        | 10639/54000 [00:06<00:26, 1643.02it/s] 20%|██        | 10805/54000 [00:06<00:26, 1646.49it/s] 20%|██        | 10970/54000 [00:07<00:26, 1643.64it/s] 21%|██        | 11135/54000 [00:07<00:26, 1610.47it/s] 21%|██        | 11298/54000 [00:07<00:26, 1613.72it/s] 21%|██        | 11462/54000 [00:07<00:26, 1618.78it/s] 22%|██▏       | 11626/54000 [00:07<00:26, 1622.46it/s] 22%|██▏       | 11789/54000 [00:07<00:26, 1604.33it/s] 22%|██▏       | 11954/54000 [00:07<00:26, 1616.74it/s] 22%|██▏       | 12116/54000 [00:07<00:29, 1426.74it/s] 23%|██▎       | 12282/54000 [00:07<00:28, 1487.20it/s] 23%|██▎       | 12446/54000 [00:08<00:27, 1529.66it/s] 23%|██▎       | 12608/54000 [00:08<00:26, 1555.57it/s] 24%|██▎       | 12773/54000 [00:08<00:26, 1581.26it/s] 24%|██▍       | 12937/54000 [00:08<00:25, 1595.99it/s] 24%|██▍       | 13102/54000 [00:08<00:25, 1610.85it/s] 25%|██▍       | 13266/54000 [00:08<00:25, 1618.23it/s] 25%|██▍       | 13429/54000 [00:08<00:25, 1621.03it/s] 25%|██▌       | 13593/54000 [00:08<00:24, 1626.58it/s] 25%|██▌       | 13758/54000 [00:08<00:24, 1633.10it/s] 26%|██▌       | 13923/54000 [00:08<00:24, 1636.34it/s] 26%|██▌       | 14087/54000 [00:09<00:24, 1636.86it/s] 26%|██▋       | 14252/54000 [00:09<00:24, 1639.21it/s] 27%|██▋       | 14416/54000 [00:09<00:24, 1613.56it/s] 27%|██▋       | 14581/54000 [00:09<00:24, 1623.99it/s] 27%|██▋       | 14744/54000 [00:09<00:27, 1410.61it/s] 28%|██▊       | 14898/54000 [00:09<00:27, 1444.54it/s] 28%|██▊       | 15058/54000 [00:09<00:26, 1485.76it/s] 28%|██▊       | 15224/54000 [00:09<00:25, 1532.60it/s] 28%|██▊       | 15380/54000 [00:09<00:29, 1327.91it/s] 29%|██▉       | 15542/54000 [00:10<00:27, 1401.73it/s] 29%|██▉       | 15703/54000 [00:10<00:26, 1456.63it/s] 29%|██▉       | 15861/54000 [00:10<00:25, 1490.67it/s] 30%|██▉       | 16022/54000 [00:10<00:24, 1523.02it/s] 30%|██▉       | 16185/54000 [00:10<00:24, 1551.54it/s] 30%|███       | 16343/54000 [00:10<00:25, 1478.28it/s] 31%|███       | 16505/54000 [00:10<00:24, 1518.05it/s] 31%|███       | 16663/54000 [00:10<00:24, 1534.47it/s] 31%|███       | 16825/54000 [00:10<00:23, 1558.83it/s] 31%|███▏      | 16987/54000 [00:10<00:23, 1574.73it/s] 32%|███▏      | 17150/54000 [00:11<00:23, 1589.58it/s] 32%|███▏      | 17311/54000 [00:11<00:23, 1594.06it/s] 32%|███▏      | 17473/54000 [00:11<00:22, 1599.80it/s] 33%|███▎      | 17636/54000 [00:11<00:22, 1607.17it/s] 33%|███▎      | 17797/54000 [00:11<00:22, 1602.96it/s] 33%|███▎      | 17959/54000 [00:11<00:22, 1606.95it/s] 34%|███▎      | 18121/54000 [00:11<00:22, 1607.98it/s] 34%|███▍      | 18284/54000 [00:11<00:22, 1611.94it/s] 34%|███▍      | 18446/54000 [00:11<00:22, 1607.48it/s] 34%|███▍      | 18607/54000 [00:11<00:23, 1518.65it/s] 35%|███▍      | 18768/54000 [00:12<00:22, 1544.18it/s] 35%|███▌      | 18931/54000 [00:12<00:22, 1567.32it/s] 35%|███▌      | 19092/54000 [00:12<00:22, 1579.59it/s] 36%|███▌      | 19254/54000 [00:12<00:21, 1591.34it/s] 36%|███▌      | 19414/54000 [00:12<00:21, 1590.53it/s] 36%|███▋      | 19576/54000 [00:12<00:21, 1597.53it/s] 37%|███▋      | 19737/54000 [00:12<00:21, 1600.70it/s] 37%|███▋      | 19898/54000 [00:12<00:21, 1590.62it/s] 37%|███▋      | 20058/54000 [00:12<00:21, 1587.18it/s] 37%|███▋      | 20220/54000 [00:12<00:21, 1596.33it/s] 38%|███▊      | 20381/54000 [00:13<00:21, 1599.74it/s] 38%|███▊      | 20543/54000 [00:13<00:20, 1604.52it/s] 38%|███▊      | 20705/54000 [00:13<00:20, 1606.20it/s] 39%|███▊      | 20867/54000 [00:13<00:20, 1608.18it/s] 39%|███▉      | 21028/54000 [00:13<00:20, 1582.72it/s] 39%|███▉      | 21187/54000 [00:13<00:20, 1584.00it/s] 40%|███▉      | 21350/54000 [00:13<00:20, 1595.61it/s] 40%|███▉      | 21511/54000 [00:13<00:20, 1599.84it/s] 40%|███▉      | 21548/54000 [00:13<00:20, 1558.77it/s]
Traceback (most recent call last):
  File "main.py", line 100, in <module>
    main(args)
  File "main.py", line 87, in main
    network.train(x_train, y_train, x_val, y_val)
  File "/cbr/saish/PhD/DL/Assignment_1/FeedForwardNN.py", line 557, in train
    self.do_nesterov_accelerated_gradient_descent(x_train, y_train, x_val, y_val)
  File "/cbr/saish/PhD/DL/Assignment_1/FeedForwardNN.py", line 300, in do_nesterov_accelerated_gradient_descent
    current_gradients = self.backwardPropagation(y, activations, pre_activations)
  File "/cbr/saish/PhD/DL/Assignment_1/FeedForwardNN.py", line 130, in backwardPropagation
    gradients['W' + str(k)] = np.outer(gradients['a' + str(k)], activations['h' + str(k-1)])
  File "<__array_function__ internals>", line 6, in outer
  File "/cbr/saish/.local/lib/python3.7/site-packages/numpy/core/numeric.py", line 909, in outer
    return multiply(a.ravel()[:, newaxis], b.ravel()[newaxis, :], out)
KeyboardInterrupt
